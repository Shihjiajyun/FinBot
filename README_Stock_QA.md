# FinBot 股票智能問答功能

## 🎯 **功能概述**

基於 10-K 報告摘要資料的股票智能問答系統，讓用戶可以針對特定股票提出問題，並獲得基於真實財報數據的專業回答。

## ✨ **主要特色**

### 🔍 **智能數據整合**
- 自動整合該股票的 10-K 報告摘要資料
- 根據問題類型智能選擇相關的報告章節
- 保留所有重要的財務數據和量化指標

### 🤖 **GPT 專業分析**
- 使用 GPT-4-turbo 進行深度分析
- 只基於真實摘要資料回答，避免幻覺內容
- 專業的財務分析師角色設定

### 💾 **智能快取系統**
- 檢測重複問題，直接返回快取答案
- 提升回答速度，節省 API 成本
- 標示快取答案來源

### 📊 **對話歷史追蹤**
- 自動建立以股票代號命名的對話
- 完整的問答歷史記錄
- 時間戳記和回答狀態追蹤

## 🚀 **使用方法**

### 1. **進入股票查詢**
1. 登入 FinBot 系統
2. 點擊側邊欄的「股票查詢」按鈕
3. 輸入股票代號（如：AAPL、TSLA、MSFT）

### 2. **查看股票資訊**
- 系統顯示股票基本資訊和財務數據
- 10-K 檔案列表（如有）
- 智能問答區塊自動載入

### 3. **提出問題**
- 在問答區域輸入您的問題
- 或點擊建議問題快速提問
- 支援 Enter 鍵快速發送

### 4. **查看回答**
- 即時顯示思考動畫
- 基於 10-K 摘要的專業回答
- 快取答案會有特殊標示

## 💡 **建議問題類型**

### 📈 **業務相關**
- "公司的主要業務和產品是什麼？"
- "競爭優勢和市場地位如何？"
- "業務模式有什麼特色？"

### ⚠️ **風險評估**
- "最主要的風險因素有哪些？"
- "面臨哪些市場挑戰？"
- "風險管理策略如何？"

### 💰 **財務表現**
- "近年來的財務表現如何？"
- "營收成長趨勢怎麼樣？"
- "獲利能力分析？"

### 👥 **治理結構**
- "管理層薪酬結構如何？"
- "董事會組成情況？"
- "公司治理政策？"

## 🏗️ **技術架構**

### **前端技術**
- **JavaScript ES6+**: 問答功能實現
- **Bootstrap 5**: 響應式界面設計
- **CSS3**: 動畫效果和樣式
- **Fetch API**: 異步數據載入

### **後端技術**
- **PHP 8.x**: 服務端邏輯
- **MySQL**: 數據存儲
- **OpenAI GPT-4-turbo**: AI 問答生成
- **RESTful API**: 前後端通訊

### **數據流程**
```
用戶提問 → 檢查快取 → 獲取10-K摘要 → GPT分析 → 儲存記錄 → 返回答案
```

## 📁 **檔案結構**

```
FinBot/php/
├── stock_qa_api.php           # 股票問答 API
├── js/stock-query.js          # 股票查詢 JavaScript（已擴展問答功能）
├── css/index.css              # 樣式文件（已添加問答樣式）
└── index.php                  # 主頁面（已整合問答界面）
```

## 🗄️ **資料庫設計**

### **conversations 表**
- 存儲以股票代號命名的對話
- 自動建立和更新對話

### **questions 表**
- 問題與答案的完整記錄
- 關聯到對話和用戶

### **user_questions 表**
- 用戶問題歷史追蹤
- 支援統計和分析

### **ten_k_filings_summary 表**
- 10-K 報告摘要資料來源
- 智能內容選擇基礎

## 🔧 **API 接口**

### **獲取問答歷史**
```
POST: stock_qa_api.php
action: get_stock_qa_history
ticker: 股票代號
```

### **提出股票問題**
```
POST: stock_qa_api.php
action: ask_stock_question
ticker: 股票代號
question: 問題內容
```

## 🎨 **界面特色**

### **響應式設計**
- 桌面端：完整功能顯示
- 平板端：優化佈局調整
- 手機端：垂直佈局適配

### **視覺效果**
- 思考動畫：顯示 AI 分析進度
- 快取標籤：區分新回答和快取回答
- 時間顯示：友善的相對時間

### **用戶體驗**
- Enter 鍵快速發送
- 建議問題一鍵提問
- 滾動自動定位到新回答

## ⚡ **性能優化**

### **快取機制**
- 相同問題直接返回快取答案
- 減少 GPT API 調用成本
- 提升回答速度

### **智能內容選擇**
- 根據問題類型選擇相關摘要
- 避免無關內容干擾
- 提高回答準確性

### **異步處理**
- 非阻塞的問答處理
- 即時的進度回饋
- 良好的用戶體驗

## 🔒 **安全特性**

### **輸入驗證**
- 股票代號格式檢查
- 問題內容長度限制
- 用戶身份驗證

### **數據保護**
- SQL 注入防護
- XSS 攻擊防護
- API 訪問控制

## 📊 **數據來源保證**

### **基於真實數據**
- 只使用 10-K 摘要資料回答
- 明確標示數據來源和時間
- 避免 AI 幻覺問題

### **專業分析**
- 財務分析師角色設定
- 保留量化指標和數據
- 提供結構化回答

## 🚦 **使用注意事項**

1. **數據依賴性**：回答品質取決於 10-K 摘要的完整性
2. **時效性**：基於最新可用的 10-K 報告數據
3. **限制性**：只回答摘要中包含的內容
4. **專業性**：建議結合其他資訊來源進行投資決策

## 🔄 **未來擴展**

- 支援更多財報類型（10-Q、8-K 等）
- 多語言問答支援
- 圖表化回答展示
- 問答品質評分系統

---

**🎉 現在您可以開始使用 FinBot 的股票智能問答功能，獲得基於真實財報的專業分析！** 